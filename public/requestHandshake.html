<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Steem Keychain Handshake Test</title>
</head>
<body>

<h2>Steem Keychain Handshake Test</h2>
<button id="test">Handshake å®Ÿè¡Œ</button>

<pre id="result"></pre>

<script>
const out = document.getElementById("result");

// Keychain â†’ ãƒšãƒ¼ã‚¸ã¸ã®è¿”ä¿¡ã‚’å—ã‘å–ã‚‹
window.addEventListener("message", (event) => {
    if (event.data && event.data.command === "handshake") {
        out.textContent += "\n\nğŸŸ© Keychain å¿œç­”:\n" +
            JSON.stringify(event.data, null, 2);
    }
});

document.getElementById("test").onclick = () => {

    if (!window.steem_keychain) {
        out.textContent = "âŒ Keychain ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚";
        return;
    }

    out.textContent = "â³ Handshake ã‚’é€ä¿¡ã—ã¾ã—ãŸâ€¦";

    // v3/v4 ã©ã¡ã‚‰ã§ã‚‚ OKï¼ˆcallback ã¯ res ãŒ undefined ã®å ´åˆã‚ã‚Šï¼‰
    steem_keychain.requestHandshake((res) => {
        out.textContent += "\n\ncallback å—ä¿¡: " + JSON.stringify(res, null, 2);
    });
};
</script>

</body>
</html>
